import { Permissions } from '../../types';
import { checkPermission } from '../permissions.utils';
describe('checkPermission', () => {
  test.each([[{ 'test.permission': true }], [{ 'test.*': true }], [{ '*': true }]])(
    'expected truthy result',
    (permissions) => {
      const requiredPermission = 'test.permission';
      const result = checkPermission(permissions as Permissions, requiredPermission);
      expect(result).toBeTruthy();
    },
  );

  test.each([[{}], [{ 'test.permission.read': true }], [{ 'test.permission.write.*': true }]])(
    'expected falsy result',
    (permissions) => {
      const requiredPermission = 'test.permission';
      const result = checkPermission(permissions as Permissions, requiredPermission);
      expect(result).toBeFalsy();
    },
  );
});
