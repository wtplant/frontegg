"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.stepUpHostedLogin = stepUpHostedLogin;
var _saga = require("../LoginState/saga");
var _consts = require("./consts");
var _utils = require("./utils");
var _effects = require("redux-saga/effects");
/**
 * Step up for hosted login apps
 * @param payload.maxAge
 */
function* stepUpHostedLogin({
  payload
}) {
  const params = {
    acr_values: _consts.ACR_VALUE
  };
  const {
    maxAge
  } = payload || {};
  if (maxAge !== undefined) {
    params.max_age = maxAge.toString();
  }
  const alias = yield (0, _effects.select)(({
    auth
  }) => {
    var _auth$tenantsState, _auth$tenantsState$ac;
    return (_auth$tenantsState = auth.tenantsState) == null ? void 0 : (_auth$tenantsState$ac = _auth$tenantsState.activeTenant) == null ? void 0 : _auth$tenantsState$ac.alias;
  });
  if (alias) {
    params.organization = alias;
  }
  (0, _utils.setAfterAuthRedirectUrlForStepUp)();
  window.localStorage.setItem(_consts.SHOULD_STEP_UP_KEY, 'true');
  yield (0, _saga.requestHostedLoginAuthorize)(params);
}