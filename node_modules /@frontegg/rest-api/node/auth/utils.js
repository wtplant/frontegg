"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.executeConditionalPromise = executeConditionalPromise;
exports.getCurrentUserTenantsFunction = getCurrentUserTenantsFunction;
exports.getTabTenantFromSessionStorage = getTabTenantFromSessionStorage;
exports.setTabTenantInSessionStorage = setTabTenantInSessionStorage;

var _ContextHolder = require("../ContextHolder");

var _constants = require("./constants");

var _featureFlags = require("../feature-flags");

var _users = require("../users");

;

async function executeConditionalPromise({
  shouldLoad,
  action
}) {
  if (!shouldLoad) return;
  return await action();
}

function setTabTenantInSessionStorage(tenantId) {
  if (!tenantId) {
    return;
  }

  sessionStorage.setItem(_constants.FRONTEGG_SEPARATE_TABS_BY_TENANT, tenantId);
}

function getTabTenantFromSessionStorage() {
  if (!_ContextHolder.ContextHolder.isSessionPerTenantEnabled()) {
    return null;
  }

  return sessionStorage.getItem(_constants.FRONTEGG_SEPARATE_TABS_BY_TENANT);
}

function getCurrentUserTenantsFunction() {
  const [useCurrentUserTenantsV1] = _featureFlags.FeatureFlags.getFeatureFlags([_constants.USE_CURRENT_USER_TENANTS_V1_ENDPOINT_FF], _ContextHolder.ContextHolder.getAppName() || '');

  if (_ContextHolder.ContextHolder.isSessionPerTenantEnabled()) {
    return _users.getCurrentUserTenantsV1;
  }

  return useCurrentUserTenantsV1 ? _users.getCurrentUserTenantsV1 : _users.getCurrentUserTenantsV3;
}