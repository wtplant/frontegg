"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.bulkCreateIPRestriction = bulkCreateIPRestriction;
exports.createDomainRestriction = createDomainRestriction;
exports.createIPRestriction = createIPRestriction;
exports.deleteDomainRestriction = deleteDomainRestriction;
exports.deleteIPRestriction = deleteIPRestriction;
exports.getCaptchaPolicy = getCaptchaPolicy;
exports.getDomainRestrictions = getDomainRestrictions;
exports.getDomainRestrictionsConfig = getDomainRestrictionsConfig;
exports.getGlobalSecurityPolicy = getGlobalSecurityPolicy;
exports.getIPRestrictions = getIPRestrictions;
exports.getIPRestrictionsConfig = getIPRestrictionsConfig;
exports.getLockoutPolicy = getLockoutPolicy;
exports.getMfaPolicy = getMfaPolicy;
exports.getPasswordConfigPolicy = getPasswordConfigPolicy;
exports.getPasswordHistoryPolicy = getPasswordHistoryPolicy;
exports.getVendorLockoutPolicy = getVendorLockoutPolicy;
exports.getVendorMfaPolicy = getVendorMfaPolicy;
exports.getVendorPasswordHistoryPolicy = getVendorPasswordHistoryPolicy;
exports.saveLockoutPolicy = saveLockoutPolicy;
exports.saveMfaPolicy = saveMfaPolicy;
exports.savePasswordHistoryPolicy = savePasswordHistoryPolicy;
exports.testCurrentIp = testCurrentIp;
exports.testCurrentIpInAllowList = testCurrentIpInAllowList;
exports.updateDomainRestrictionConfig = updateDomainRestrictionConfig;
exports.updateIPRestrictionConfig = updateIPRestrictionConfig;

var _fetch = require("../../fetch");

var _constants = require("../../constants");

async function getGlobalSecurityPolicy() {
  return (0, _fetch.Get)(_constants.urls.identity.configurations.v1);
}

async function getMfaPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/mfa-policy`);
}

async function getVendorMfaPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/mfa-policy/vendor`);
}

async function saveMfaPolicy(body) {
  if (body.id) {
    return (0, _fetch.Patch)(`${_constants.urls.identity.configurations.v1}/mfa-policy`, body);
  } else {
    return (0, _fetch.Post)(`${_constants.urls.identity.configurations.v1}/mfa-policy`, body);
  }
}

async function getLockoutPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/lockout-policy`);
}

async function getVendorLockoutPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/lockout-policy/vendor`);
}

async function saveLockoutPolicy(body) {
  if (body.id) {
    return (0, _fetch.Patch)(`${_constants.urls.identity.configurations.v1}/lockout-policy`, body);
  } else {
    return (0, _fetch.Post)(`${_constants.urls.identity.configurations.v1}/lockout-policy`, body);
  }
}

async function getCaptchaPolicy() {
  try {
    return await (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/captcha-policy/public`);
  } catch {
    return null;
  }
}

async function getPasswordHistoryPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/password-history-policy`);
}

async function getVendorPasswordHistoryPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/password-history-policy/vendor`);
}

async function savePasswordHistoryPolicy(body) {
  if (body.id) {
    return (0, _fetch.Patch)(`${_constants.urls.identity.configurations.v1}/password-history-policy`, body);
  } else {
    return (0, _fetch.Post)(`${_constants.urls.identity.configurations.v1}/password-history-policy`, body);
  }
}

async function getPasswordConfigPolicy() {
  return (0, _fetch.Get)(`${_constants.urls.identity.configurations.v1}/password`);
}

async function getDomainRestrictions() {
  return (0, _fetch.Get)(`${_constants.urls.identity.restrictions.emailDomain.v1}`);
}

async function getDomainRestrictionsConfig() {
  return (0, _fetch.Get)(`${_constants.urls.identity.restrictions.emailDomain.v1}/config`);
}

async function createDomainRestriction(body) {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.emailDomain.v1}`, body);
}

async function updateDomainRestrictionConfig(body) {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.emailDomain.v1}/config`, body);
}

async function deleteDomainRestriction(id) {
  return (0, _fetch.Delete)(`${_constants.urls.identity.restrictions.emailDomain.v1}/${id}`);
}

async function getIPRestrictions(params) {
  return (0, _fetch.Get)(`${_constants.urls.identity.restrictions.ip.v1}`, params);
}

async function getIPRestrictionsConfig() {
  return (0, _fetch.Get)(`${_constants.urls.identity.restrictions.ip.v1}/config`);
}

async function createIPRestriction(body) {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.ip.v1}`, body);
}

async function bulkCreateIPRestriction(body) {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.ip.v1}/bulk`, body);
}

async function updateIPRestrictionConfig(body) {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.ip.v1}/config`, body);
}

async function deleteIPRestriction(id) {
  return (0, _fetch.Delete)(`${_constants.urls.identity.restrictions.ip.v1}/${id}`);
}

async function testCurrentIp() {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.ip.v1}/verify`);
}

async function testCurrentIpInAllowList() {
  return (0, _fetch.Post)(`${_constants.urls.identity.restrictions.ip.v1}/verify/allow`);
}