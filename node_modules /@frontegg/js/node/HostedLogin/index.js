"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.HostedLogin = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _reduxStore = require("@frontegg/redux-store");
var _AppHolder = require("../AppHolder");
var _restApi = require("@frontegg/rest-api");
var HostedLogin = /*#__PURE__*/function () {
  function HostedLogin() {
    (0, _classCallCheck2["default"])(this, HostedLogin);
  }
  (0, _createClass2["default"])(HostedLogin, null, [{
    key: "setAuthentication",
    value: function setAuthentication(isAuthenticated, accessToken, user) {
      var appName = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 'default';
      var app = _AppHolder.AppHolder.getInstance(appName);
      if (isAuthenticated && accessToken) {
        _restApi.ContextHolder.setAccessToken(accessToken);
        _restApi.ContextHolder.setUser(Object.assign({}, user, {
          accessToken: accessToken
        }));
        app.store.dispatch(_reduxStore.authActions.setState({
          isLoading: false,
          isAuthenticated: isAuthenticated,
          user: user
        }));
        app.store.dispatch(_reduxStore.authActions.loadTenants());
      } else {
        _restApi.ContextHolder.setAccessToken(null);
        _restApi.ContextHolder.setUser(null);
        app.store.dispatch(_reduxStore.authActions.setState({
          isLoading: false,
          isAuthenticated: false,
          user: null
        }));
      }
    }
  }]);
  return HostedLogin;
}();
exports.HostedLogin = HostedLogin;